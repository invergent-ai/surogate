# Bias Primitives
# Native implementations: csrc/src/kernels/bias.cu

primitive bias_add:
  """
  Add bias vector to the last dimension.
  """

  forward:
    in: (x: [B, T, C], bias: [C])
    out: [B, T, C]
    _

  impl:
    forward: kernels.add_bias


primitive bias_backward:
  """
  Compute bias gradients by summing over batch and sequence.
  """

  forward:
    in: d_out: [B, T, C]
    out: d_bias: [C]
    _

  impl:
    forward: kernels.backward_bias
